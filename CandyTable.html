<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Candy Bar Tables Problem">
    <meta name="author" content="Amy Thompson">
    <!-- <link rel="icon" href="favicon.ico"> -->

    <title>Candy Bar Tables</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">

    <style>
        body {
      padding-top: 5rem;
    }
  
    .starter-template {
      padding: 3rem 1.5rem;
      text-align: center;
    }

    .border-left{
      border-left:1px solid #dee2e6;
    }

    .border-right{
      border-right:1px solid #dee2e6;
    }
  </style>

</head>

<body>

    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
        <a class="navbar-brand" href="#">Candy Bar Tables</a>
        <!-- <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault"
      aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarsExampleDefault">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active">
          <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Link</a>
        </li>
        <li class="nav-item">
          <a class="nav-link disabled" href="#">Disabled</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="https://example.com" id="dropdown01" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">Dropdown</a>
          <div class="dropdown-menu" aria-labelledby="dropdown01">
            <a class="dropdown-item" href="#">Action</a>
            <a class="dropdown-item" href="#">Another action</a>
            <a class="dropdown-item" href="#">Something else here</a>
          </div>
        </li>
      </ul>
      <form class="form-inline my-2 my-lg-0">
        <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
      </form>
    </div> -->
    </nav>

    <main role="main" class="container">
        <div class="row mb-5">
            <div class="col">
                <!-- <h1>Candy Bar Tables</h1> -->

                <form>
                    <div class="form-group">
                        <label for="numKids">Number of Kids:</label>
                        <input type="text" class="form-control" id="numKids" placeholder="Number of Kids" value="10">
                    </div>

                    <div class="form-group">
                        <label for="numCandyBarsTable1">Table 1 number of Candy Bars:</label>
                        <input type="text" class="form-control" id="numCandyBarsTable1" placeholder="Table 1 number of Candy Bars" value="5">
                    </div>

                    <div class="form-group">
                        <label for="numCandyBarsTable2">Table 2 number of Candy Bars:</label>
                        <input type="text" class="form-control" id="numCandyBarsTable2" placeholder="Table 2 number of Candy Bars" value="3">
                    </div>

                    <div class="form-group">
                        <label for="numCandyBarsTable3">Table 3 number of Candy Bars:</label>
                        <input type="text" class="form-control" id="numCandyBarsTable3" placeholder="Table 3 number of Candy Bars" value="2">
                    </div>

                    <button id="simulateButton" type="submit" class="btn btn-primary">Simulate</button>
                </form>
            </div>
        </div>

        <div class="row">
            <div class="col">
                <table class="table">
                    <thead>
                        <tr>
                            <th class="border-right"></th>
                            <th scope="colgroup" colspan="2" class="border-right">Table 1</th>
                            <th scope="colgroup" colspan="2" class="border-right">Table 2</th>
                            <th scope="colgroup" colspan="2">Table 3</th>
                        </tr>
                        <tr>
                            <th scope="col" class="border-right">Step</th>
                            <th scope="col"># Kids</th>
                            <th scope="col" class="border-right"># Candy Bars per Kid</th>
                            <th scope="col"># Kids</th>
                            <th scope="col" class="border-right"># Candy Bars per Kid</th>
                            <th scope="col"># Kids</th>
                            <th scope="col"># Candy Bars per Kid</th>
                        </tr>
                    </thead>
                    <tbody id="tableContents">
                        <!-- <tr>
                            <th scope="row" class="border-right">1</th>
                            <td>1</td>
                            <td class="border-right">5</td>
                            <td>0</td>
                            <td class="border-right">0</td>
                            <td>0</td>
                            <td>0</td>
                        </tr>
                        <tr>
                            <th scope="row" class="border-right">2</th>
                            <td>2</td>
                            <td class="border-right">2.5</td>
                            <td>0</td>
                            <td class="border-right">0</td>
                            <td>0</td>
                            <td>0</td>
                        </tr> -->
                    </tbody>
                </table>
            </div>
        </div>

    </main><!-- /.container -->

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <script>
        $(function () {
            $('#simulateButton').on('click', (ev) => {
                ev.preventDefault();
                $('#simulateButton').prop('disabled', true);
                console.clear();
                $('#tableContents').empty();
                console.log('starting simulation');
                try {
                    var numKids = parseFloat($('#numKids').val());
                    var table1Bars = parseFloat($('#numCandyBarsTable1').val());
                    var table2Bars = parseFloat($('#numCandyBarsTable2').val());
                    var table3Bars = parseFloat($('#numCandyBarsTable3').val());
                    runSimulation(numKids, table1Bars, table2Bars, table3Bars);
                }
                catch (err) {
                    console.error('error running simulation', err);
                }
                finally {
                    $('#simulateButton').prop('disabled', false);
                    console.log('simulation complete');
                }
            });
        });

        function runSimulation(numKids, table1Bars, table2Bars, table3Bars) {
            var kids = [];
            var tables = [{ candyBars: table1Bars, numKids: 0 }, { candyBars: table2Bars, numKids: 0 }, { candyBars: table3Bars, numKids: 0 }];
            for (var i = 0; i < numKids; i++) {
                addTableRow(i, tables, bestTableIndex);
                var bestTableIndex = enterRoom(i + 1, tables, kids);
                printStatus(tables);
            }
            addTableRow(i, tables);
        }

        function addTableRow(stepNum, tables, bestTableIndex) {
            // if (stepNum == 0) {
            //     return;
            // }
            var table1CandyBarsPerKid = tables[0].numKids > 0 ? tables[0].candyBars / tables[0].numKids : 'NA';
            var table2CandyBarsPerKid = tables[1].numKids > 0 ? tables[1].candyBars / tables[1].numKids : 'NA';
            var table3CandyBarsPerKid = tables[2].numKids > 0 ? tables[2].candyBars / tables[2].numKids : 'NA';
            
            var table1Class = bestTableIndex == 0 ? 'bg-success' : '';
            var table2Class = bestTableIndex == 1 ? 'bg-success' : '';
            var table3Class = bestTableIndex == 2 ? 'bg-success' : '';
            
            var row = `
                <tr>
                    <th scope="row" class="border-right">${stepNum}</th>
                    <td class="${table1Class}">${tables[0].numKids}</td>
                    <td class="border-right">${table1CandyBarsPerKid}</td>
                    <td class="${table2Class}">${tables[1].numKids}</td>
                    <td class="border-right">${table2CandyBarsPerKid}</td>
                    <td class="${table3Class}">${tables[2].numKids}</td>
                    <td>${table3CandyBarsPerKid}</td>
                </tr>
            `;
            $('#tableContents').append(row);
        }

        function enterRoom(studentNumber, tables, kids) {
            var bestTableIndex = determineBestTableIndex(tables);
            tables[bestTableIndex].numKids++;
            return bestTableIndex;
        }

        function determineBestTableIndex(tables) {
            var tableCalculations = [];
            for (var i = 0; i < tables.length; i++) {
                var numKids = tables[i].numKids + 1;
                var candyBarsPerKid = tables[i].candyBars / numKids;
                tableCalculations.push(candyBarsPerKid);
            }
            var highest = { index: 0, candyBarsPerKid: tableCalculations[0] };
            for (var i = 1; i < tableCalculations.length; i++) {
                if (tableCalculations[i] > highest.candyBarsPerKid) {
                    highest = { index: i, calc: tableCalculations[i] };
                }
            }
            return highest.index;
        }

        function printStatus(tables) {
            for (var i = 0; i < tables.length; i++) {
                if (tables[i].numKids === 0) {
                    console.log('Table ' + (i + 1) + ' has 0 kids');
                }
                else {
                    var candyBarAmount = tables[i].candyBars / tables[i].numKids;
                    var message = 'Table ' + (i + 1) + ' has ' + tables[i].numKids + ' Kids and each kid gets ' + candyBarAmount + ' candy bar';
                    console.log(message);
                }
            }
            console.log('-----------');
        }

    </script>
</body>

</html>